<!DOCTYPE html>
<html>
    <head>
        <% include head %>
        <script type="text/javascript">
            window.onload = function fetchMsgs() {
                console.log("Fetching...");

                //AJAX req to get messages
                $.get("/channel/1", (res) => {displayMsgs(res)});
            }

            function displayMsgs(res) {
                console.log(res);
                $.each(res, (i, msg) => {
                    console.log(msg["content"]);
                    ($(msgs)
                    .append("<div class='msgDiv'><div class='post'><p>" + msg["content"] + "</p></div><span id='timestamp'>" + msg['timestamp'] + "</span></div>"));
                });
            }
        </script>
    </head>

    <body>
        <% include header %>
        <script type="text/javascript">document.getElementById("home").className="active";</script>

        <div id="main">
                <h1>PEYTON'S CHAT</h1>

                <div id="msgs">
                    <div class="msgDiv">
                        <div class="post">
                            <p>MESSAGE 1</p>
                        </div>
                    </div>

                    <div class="msgDiv">
                        <div class="mine post">
                            <p>MESSAGE 2: So I really really really like this class because it's just so much fun, and I really like developing web applications like this one. I hope it turns out good so people will be impressed when I present this project!</p>
                        </div>
                    </div>

                    <div class="msgDiv">
                        <div class="post">
                            <p>MESSAGE 3</p>
                        </div>
                    </div>
                </div>

                <div id="createMsg">
                    <form action="/postMsg" method="post">
                        <input type="hidden" name="user" value="1">
                        <input type="hidden" name="channel" value="1">
                        <input type="hidden" name="parent" value="0">
                        <input type="text" name="content"><input type="submit" name="submit" value="SEND">
                    </form>
                </div>
        </div>

        <% include footer %>
    </body>
</html>
